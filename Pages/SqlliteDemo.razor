@page "/SqlliteDemo"

@using Microsoft.EntityFrameworkCore
@using TheWallet.Data
@using TheWallet.Models


<PageTitle>Sqllite Demo</PageTitle>

@code {
  [Inject]
  private IDbContextFactory<TheWalletDBContext> _dbContextFactory { get; set; }

  protected override async Task OnInitializedAsync()
  {
    await using var db = await _dbContextFactory.CreateDbContextAsync();
    await db.Database.EnsureCreatedAsync();

    // create seed data
     if (!db.Finances.Any())
    {
      var Finances = new[]
      {
        new Finance {Id = 1, Amount = 1000, CreateDate = DateTime.Now, UpdateDate = DateTime.Now, Description = "as" },
        new Finance { Id = 2, Amount = 1000, CreateDate = DateTime.Now, UpdateDate = DateTime.Now, Description = "as" }
      };

      await db.Finances.AddRangeAsync(Finances);
      await db.SaveChangesAsync();
    }

    await db.Finances.ToListAsync();

    await base.OnInitializedAsync();
  }
}